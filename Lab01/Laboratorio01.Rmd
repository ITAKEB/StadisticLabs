---
title: "Laboratorio 01"
output:
    pdf_document: default
date: "2023-02-08"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Bloque 0

### Problema 1

```{r, p1}
  x = c(1,2,3,4)
  y = seq(1:10)
  z = seq(2,10,2)
  w = rep(0,10)
  y[3] = 1
```

### Problema 2
```{r, p2}
  curve(x+1, from=1, to=10 ,xlab="x", ylab="y")
  curve((x^2)+1, from=1, to=10, xlab="x", ylab="y")
  curve(sin(x), from=1, to=10, xlab="x", ylab="y")
  curve(cos(x), from=1, to=10, xlab="x", ylab="y")
  curve(log(x), from=1, to=10, xlab="x", ylab="y")
```


### Problema 3
```{r,p3}
  curve(x+1, from=1, to=10 ,xlab="x", ylab="y")
  curve((x^2)+1, from=1, to=10, xlab="x", ylab="y")
  curve(sin(x), from=1, to=10, xlab="x", ylab="y")
  curve(cos(x), from=1, to=10, xlab="x", ylab="y")
  curve(log(x), from=1, to=10, xlab="x", ylab="y")
```


### Problema 4
```{r, p4}
library(readr)
dat = read_csv("./pizzadelivery.csv")
  #str(dat)
  #dim(dat)
  #colnames(dat)
  #names(dat)
  #nrow(dat)
  #ncol(dat)
  #head(dat)
  #tail(dat)
  dat["temperature"] = (dat["temperature"] * (9/5)) + 32
  dat[dat$driver == 'Domenico',]
  dat[dat$pizzas >= 4,"day"]
```

## Bloque 1

### Problema 5
- day : cualitativa-discreta
- date : cualitativa-ordinal
- time : cuantitativa-discreta
- operator : cualitativa-nominal
- branch : cualitativa - ? 
- driver : cualitativa-nominal
- temperature : cuantitativa-continua
- bill : cuantitativa-discreta
- pizzas : cuantitativa-discreta
- free_wine : cualitativa-nominal
- got_wine : cualitativa-nominal
- discount_customer : cualitativa- ?

### Problema 6

```{r p6}
  fi = table(dat$driver)
  hi = fi/length(dat$driver)
  barplot(fi)
  tabla = cbind(fi,hi)
```
### Problema 7

```{r}
table(dat[dat$free_wine==TRUE,7])
```

### Problema 8

```{r}
table(dat[dat$free_wine==T & dat$got_wine==T,6])
```


## Bloque 2

### Problema 1

#### Temperature
Como podemos observar en la siguiente tabla de frecuencia, la temperatura más habitual con la que se entrega la pizza varía en un rango dentro de (145,152] y (137,145], siendo el primero el más común. Además, la temperatura menos habitual se encuentra en un rango de (190,197], siendo solo 1 pizza la que se entregó con esta temperatura. Cabe recalcar que esta tabla de frecuencia se hizo con una número de clase igual a 5 para su análisis.

```{r}
    # Temperature
    # library(readr)
    # db = read_csv("./pizzadelivery.csv")
    # Variable: Time
    temp_list = dat$temperature
    
    # Calculate information to create frequency table
    min= min(temp_list)
    max = max(temp_list)
    length = length(temp_list)
    range = max - min
    class_num = round(1 + log(length, 2))
    class_width = round(range / class_num, 2)
    
    print(c("Min", min))
    print(c("Max", max))
    print(c("Length", length))
    print(c("Range", range))
    print(c("Class Number", class_num))
    print(c("Class Width", class_width))
    
    #Calculate intervals and midpoints
    sequ = seq(min, max + class_width, class_width)
    intervals = cut(temp_list, sequ, right = TRUE, include.lowest = TRUE)
    abs_freq = table(intervals)
    midpoints = round((head(sequ, -1) + diff(sequ) / 2), 2)
    
    #Generate frequency table
    freq_table = cbind(
        Mark = midpoints,
        Abs = abs_freq, 
        Reltv = round(abs_freq / length(temp_list), 2), 
        Acm = cumsum(abs_freq),
        ReAcm = round(cumsum(abs_freq) / length(temp_list))
    )
    
    print(freq_table)
```
#### Time
Por medio del siguiente gráfico, podemos notar como el tiempo más usual de una entrega se tarde entre 28.6 y 36.8 minutos, puesto que el 45% de las pizzas son entregadas en este periodo de tiempo. Por otro lado, lo menos habitual es que una pizza sea entregada en un periodo de 12.3 y 20.5 minutos, ya que solo el 2.21% de las pizzas son entregadas durante este.

```{r}
  #time
  min = min(dat$time)
  max = max(dat$time)
  k = 5
  A = (max-min)/ k
  
  intervals = cut(dat$time, breaks=seq(min, max, by = A), Right = TRUE, include.lowest=TRUE)
  
  fi = table(intervals)
  porc = (fi/ length(dat$time))*100 
  porc = round(porc,2)
  
  pie(porc, porc, col = 2:7, main= "Time")
  legend("topleft",legend=names(fi), fill=2:7)
  
```
#### Bill
Para el caso de la variable Bill (cuenta), realizamos el análisis de frecuencia mediante el siguiente histograma, describiendo el siguiente comportamiento:
 - Entre [35, 40) y [45,50) tienen una frecuencia absoluta mayor o igual a 200
 - Entre [0, 10) tienen una frecuencia absoluta de 1

```{r}
  # bill
  fi = hist(dat$bill, xlab= "Bill", ylab = "Frequency", main= "Histogram of bill", col = 2:3)

  # fi$counts
  
```
#### Pizzas
Para finalizar, en el caso de la variable "pizzas", nos encontramos con que la cantidad pedida con mayor frecuencia va de un rango de 2 a 3 pizzas por orden. A su vez, podemos ver en la siguiente ilustración como el numero de 8, 9 y 11 pizzas son las cantidades más inusuales en la tienda.

```{r}
  fi = table(dat$pizzas)
  hi  = fi/length(dat$pizzas)
  porc = (fi/ length(dat$pizzas))*100 
  barplot(fi, col=3:4)
```

### Problema 10

```{r}
generated_freq_table = function(list_branch) {
    # Calculate information to create frequency table
    min = min(list_branch)
    max = max(list_branch)
    length = length(list_branch$temperature)
    range = max - min
    class_num = round(1 + log(length, 2))
    class_width = round(range / class_num, 2)
    
    #Calculate intervals and midpoints
    sequ = seq(min, max, class_width)
    intervals = cut(list_branch$temperature, sequ, right = TRUE, include.lowest = TRUE)
    
    abs_freq = table(intervals)
    #Generate frequency table
    freq_table = cbind(Abs = abs_freq)

    tree_diagr <- list("table" = freq_table, "sequ" = sequ)
    return(tree_diagr)
}

west = data.frame(dat[dat$branch == "West", 8])
west_table = generated_freq_table(west);
barplot(data.frame(west_table$table)$Abs ~ head(west_table$sequ, -1), 
	main = "Temperature West", 
	xlab = "Intervals", 
	ylab = "Frequency", 
	col = "blue"
)
```
```{r}
east = data.frame(dat[dat$branch == "East", 8])
east_table = generated_freq_table(east);
barplot(data.frame(east_table$table)$Abs ~ head(east_table$sequ, -1), 
	main = "Temperature East", 
	xlab = "Intervals", 
	ylab = "Frequency", 
	col = "blue"
)
```
```{r}
centre = data.frame(dat[dat$branch == "Centre", 8])
centre_table = generated_freq_table(centre);
barplot(data.frame(centre_table$table)$Abs ~ head(centre_table$sequ, -1), 
	main = "Temperature Centre", 
	xlab = "Intervals", 
	ylab = "Frequency", 
	col = "blue"
)
```

### Problema 11

```{r}
install.packages('dplyr')
suppressMessages(library(dplyr))

dat$weekend <- ifelse(dat$day == 'Friday' | dat$day == 'Saturday' | dat$day == 'Sunday', 1, 0)

gb_delivery_pzz <- dat %>%
    group_by(day) %>%
    summarise(pizzas = sum(pizzas))

gb_delivery_pzz <- gb_delivery_pzz[order(gb_delivery_pzz$pizzas, decreasing = TRUE), ]
print(gb_delivery_pzz);

weekendPizzas <- ifelse(gb_delivery_pzz$day == 'Friday' | 
		    gb_delivery_pzz$day == 'Saturday' | 
		    gb_delivery_pzz$day == 'Sunday', 
		    gb_delivery_pzz$pizzas, 0);

weekdayPizzas <- ifelse(gb_delivery_pzz$day != 'Friday' & 
		    gb_delivery_pzz$day != 'Saturday' & 
		    gb_delivery_pzz$day != 'Sunday', 
		    gb_delivery_pzz$pizzas, 0);


df <- data.frame(Week  = c("Weekday", "Weekend"), pizzas = c(sum(weekendPizzas), sum(weekdayPizzas)));

barplot(
	df$pizzas,
	main = "Pizzas days",
	xlab = "Days",
	ylab = "# pizzas",
	names.arg = df$Week,
	col = "darkred",
);

barplot(
	gb_delivery_pzz$pizzas,
	main = "# Pizzas",
	xlab = "Days",
	ylab = "# pizzas",
	names.arg = gb_delivery_pzz$day,
	col = "darkred",
);
```
